if(-not(([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator))){Add-Type -AssemblyName System.Windows.Forms;$m=[System.Windows.Forms.MessageBox];$m::Show('Run as admin','No Permission',[System.Windows.Forms.MessageBoxButtons]::OK,[System.Windows.Forms.MessageBoxIcon]::Warning);exit};Add-Type -AssemblyName System.Windows.Forms;$m=[System.Windows.Forms.MessageBox];$c=gp 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion';$p=$c.ProductName;$b=($c.CurrentBuildNumber,$c.CurrentBuild|?{$_})[0];$w11=($p-match'Windows 11'-or[int]$b-ge22000);if(-not $w11){$m::Show('Win11 only. Disable virtualization in BIOS.','BadOS',[System.Windows.Forms.MessageBoxButtons]::OK,[System.Windows.Forms.MessageBoxIcon]::Warning);exit};$reg=[Microsoft.Win32.Registry]::LocalMachine;$k=$reg.CreateSubKey('SYSTEM\CCS\Control\DG\Scenarios\WH');$k.SetValue('',0,[Microsoft.Win32.RegistryValueKind]::DWord);$m::Show("Successfully set value to 0. Now please restart your computer!`nIf it still fails, disable virtualization in BIOS.`nS/o stormpike B-)",'Success',[System.Windows.Forms.MessageBoxButtons]::OK,[System.Windows.Forms.MessageBoxIcon]::Information);exit
